(()=>{"use strict";var e={572:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var i="undefined"!=typeof window?window:null,o=null===i,s=o?void 0:i.document,a="horizontal",r=function(){return!1},l=o?"calc":["","-webkit-","-moz-","-o-"].filter((function(e){var t=s.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length})).shift()+"calc",u=function(e){return"string"==typeof e||e instanceof String},d=function(e){if(u(e)){var t=s.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},h=function(e,t,n){var i=e[t];return void 0!==i?i:n},c=function(e,t,n,i){if(t){if("end"===i)return 0;if("center"===i)return e/2}else if(n){if("start"===i)return 0;if("center"===i)return e/2}return e},m=function(e,t){var n=s.createElement("div");return n.className="gutter gutter-"+t,n},p=function(e,t,n){var i={};return u(t)?i[e]=t:i[e]=l+"("+t+"% - "+n+"px)",i},g=function(e,t){var n;return(n={})[e]=t+"px",n};const f=function(e,t){if(void 0===t&&(t={}),o)return{};var n,l,u,f,y,v,C=e;Array.from&&(C=Array.from(C));var S=d(C[0]).parentNode,_=getComputedStyle?getComputedStyle(S):null,E=_?_.flexDirection:null,w=h(t,"sizes")||C.map((function(){return 100/C.length})),T=h(t,"minSize",100),b=Array.isArray(T)?T:C.map((function(){return T})),M=h(t,"expandToMin",!1),L=h(t,"gutterSize",10),N=h(t,"gutterAlign","center"),I=h(t,"snapOffset",30),k=h(t,"dragInterval",1),D=h(t,"direction",a),O=h(t,"cursor",D===a?"col-resize":"row-resize"),P=h(t,"gutter",m),A=h(t,"elementStyle",p),R=h(t,"gutterStyle",g);function x(e,t,i,o){var s=A(n,t,i,o);Object.keys(s).forEach((function(t){e.style[t]=s[t]}))}function B(){return v.map((function(e){return e.size}))}function F(e){return"touches"in e?e.touches[0][l]:e[l]}function U(e){var t=v[this.a],n=v[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,x(t.element,t.size,this._b,t.i),x(n.element,n.size,this._c,n.i)}function z(e){var n,i=v[this.a],o=v[this.b];this.dragging&&(n=F(e)-this.start+(this._b-this.dragOffset),k>1&&(n=Math.round(n/k)*k),n<=i.minSize+I+this._b?n=i.minSize+this._b:n>=this.size-(o.minSize+I+this._c)&&(n=this.size-(o.minSize+this._c)),U.call(this,n),h(t,"onDrag",r)(B()))}function K(){var e=v[this.a].element,t=v[this.b].element,i=e.getBoundingClientRect(),o=t.getBoundingClientRect();this.size=i[n]+o[n]+this._b+this._c,this.start=i[u],this.end=i[f]}function j(e){var t=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[y];return 0===n?null:n-=D===a?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(S);if(null===t)return e;if(b.reduce((function(e,t){return e+t}),0)>t)return e;var n=0,i=[],o=e.map((function(o,s){var a=t*o/100,r=c(L,0===s,s===e.length-1,N),l=b[s]+r;return a<l?(n+=l-a,i.push(0),l):(i.push(a-l),a)}));return 0===n?e:o.map((function(e,o){var s=e;if(n>0&&i[o]-n>0){var a=Math.min(n,i[o]-n);n-=a,s=e-a}return s/t*100}))}function Y(){var e=this,n=v[e.a].element,o=v[e.b].element;e.dragging&&h(t,"onDragEnd",r)(B()),e.dragging=!1,i.removeEventListener("mouseup",e.stop),i.removeEventListener("touchend",e.stop),i.removeEventListener("touchcancel",e.stop),i.removeEventListener("mousemove",e.move),i.removeEventListener("touchmove",e.move),e.stop=null,e.move=null,n.removeEventListener("selectstart",r),n.removeEventListener("dragstart",r),o.removeEventListener("selectstart",r),o.removeEventListener("dragstart",r),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",o.style.userSelect="",o.style.webkitUserSelect="",o.style.MozUserSelect="",o.style.pointerEvents="",e.gutter.style.cursor="",e.parent.style.cursor="",s.body.style.cursor=""}function $(e){if(!("button"in e)||0===e.button){var n=this,o=v[n.a].element,a=v[n.b].element;n.dragging||h(t,"onDragStart",r)(B()),e.preventDefault(),n.dragging=!0,n.move=z.bind(n),n.stop=Y.bind(n),i.addEventListener("mouseup",n.stop),i.addEventListener("touchend",n.stop),i.addEventListener("touchcancel",n.stop),i.addEventListener("mousemove",n.move),i.addEventListener("touchmove",n.move),o.addEventListener("selectstart",r),o.addEventListener("dragstart",r),a.addEventListener("selectstart",r),a.addEventListener("dragstart",r),o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",a.style.userSelect="none",a.style.webkitUserSelect="none",a.style.MozUserSelect="none",a.style.pointerEvents="none",n.gutter.style.cursor=O,n.parent.style.cursor=O,s.body.style.cursor=O,K.call(n),n.dragOffset=F(e)-n.end}}D===a?(n="width",l="clientX",u="left",f="right",y="clientWidth"):"vertical"===D&&(n="height",l="clientY",u="top",f="bottom",y="clientHeight"),w=j(w);var W=[];function G(e){var t=e.i===W.length,n=t?W[e.i-1]:W[e.i];K.call(n);var i=t?n.size-e.minSize-n._c:e.minSize+n._b;U.call(n,i)}return(v=C.map((function(e,t){var i,o={element:d(e),size:w[t],minSize:b[t],i:t};if(t>0&&((i={a:t-1,b:t,dragging:!1,direction:D,parent:S})._b=c(L,t-1==0,!1,N),i._c=c(L,!1,t===C.length-1,N),"row-reverse"===E||"column-reverse"===E)){var s=i.a;i.a=i.b,i.b=s}if(t>0){var a=P(t,D,o.element);!function(e,t,i){var o=R(n,t,i);Object.keys(o).forEach((function(t){e.style[t]=o[t]}))}(a,L,t),i._a=$.bind(i),a.addEventListener("mousedown",i._a),a.addEventListener("touchstart",i._a),S.insertBefore(a,o.element),i.gutter=a}return x(o.element,o.size,c(L,0===t,t===C.length-1,N),t),t>0&&W.push(i),o}))).forEach((function(e){var t=e.element.getBoundingClientRect()[n];t<e.minSize&&(M?G(e):e.minSize=t)})),{setSizes:function(e){var t=j(e);t.forEach((function(e,n){if(n>0){var i=W[n-1],o=v[i.a],s=v[i.b];o.size=t[n-1],s.size=e,x(o.element,o.size,i._b,o.i),x(s.element,s.size,i._c,s.i)}}))},getSizes:B,collapse:function(e){G(v[e])},destroy:function(e,t){W.forEach((function(i){if(!0!==t?i.parent.removeChild(i.gutter):(i.gutter.removeEventListener("mousedown",i._a),i.gutter.removeEventListener("touchstart",i._a)),!0!==e){var o=A(n,i.a.size,i._b);Object.keys(o).forEach((function(e){v[i.a].element.style[e]="",v[i.b].element.style[e]=""}))}}))},parent:S,pairs:W}}},326:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n{static getName(){return null==this.username&&(this.username=localStorage.getItem(this.KEY_STORAGE)||""),this.username}static setName(e){e!==this.username&&(this.username=e,localStorage.setItem(this.KEY_STORAGE,e))}static getChatType(){return this.chatType}static setChatType(e){this.chatType=e}static useAutoNameOnSend(){return this.chatType.indexOf(this.SET_NAME_AUTOMATICALLY)>=0}static getDisplayStyle(){return this.displayStyle}static setDisplayStyle(e){this.displayStyle=e}static getIfNarrow(){return"Full"!==this.displayStyle}static getApiKey(){return this.apiKey}static setApiKey(e){this.apiKey=e}static getDebugLevel(){return this.debugLevel}static setDebugLevel(e){this.debugLevel=e}static getRoomConnectionType(){return this.roomConnectionType}static setRoomConnectionType(e){"sfu"!==e&&"mesh"!==e||(this.roomConnectionType=e)}}n.KEY_STORAGE="tmp-mkchat1-config-name",n.SET_NAME_AUTOMATICALLY="a",n.chatType="",n.displayStyle="Full",n.apiKey="",n.debugLevel=1,n.roomConnectionType="sfu",t.default=n},752:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(n(65)),l=a(n(110)),u=a(n(478)),d=a(n(222)),h=n(150),c=n(771),m=n(702),p=n(144),g=n(877),f=n(882),y=n(165),v=n(900),C=n(359),S=n(580),_=n(43),E=a(n(326)),w=a(n(572)),T=a(n(263)),b=n(795),M=n(914),L=a(n(90)),N=a(n(152));t.default=class{constructor(){this.id="",this.roomName="",this.pageTitle="",this.isErrorHandling=!1,this.IS_BROWSER_AUTH="browser",this.audioNotify=document.getElementById("audio-notify"),this.isActive=!0,this.KEY_STORAGE="config-mkchat1",this.MEDIA_QUERY_SMALL_SCREEN="screen and (max-width: 519px)";const e=localStorage.getItem(this.KEY_STORAGE);null!=e&&(l.default.w("Info","config found in localStorage"),_.AppConfig.trySetJSON(e));const t=_.AppConfig.data.getLocale();l.default.w("Info",`locale:${t}`),y.T.setLocale(t),window.addEventListener("beforeunload",(e=>{this.onBeforeUnload(e)})),window.addEventListener("unload",(e=>{this.onUnload(e)})),window.addEventListener("focus",(e=>{this.isActive=!0})),window.addEventListener("blur",(e=>{this.isActive=!1})),C.UtilDom.makeDialogsRespondToKey(),this.dialogNotify=new T.default;const n=this.makeCommEventHandlers();this.comm=new r.default(n),this.pane1=new L.default,this.pane2=new N.default,this.appControl=new u.default,this.setAppControlEvents(),this.dialogConfig=new b.DialogConfig,this.setDialogConfigEvents(),this.dialogLogin=new d.default,this.setLoginDialogEvents(),this.dialogLogin.setName(E.default.getName());const i=f.Util.beforeOf(C.UtilDom.getQuery(),"/");f.Util.isRoomNameLegit(i)&&(this.dialogLogin.setRoom(i),this.dialogLogin.hideRoom()),this.updatePageTitle(y.T.t("Login","Login")),f.Util.contains(navigator.userAgent,"MSIE","Trident","Edge")||(document.getElementById("shutter").style.display="none",this.dialogLogin.showDialog()),fetch("config.json").then((e=>e.json())).then((e=>{if("api_key"in e){const t=e.api_key;E.default.setApiKey(t),this.dialogLogin.setLoginCondition(1)}if("debug_level"in e){const t=e.debug_level;E.default.setDebugLevel(t)}if("chat_type"in e){const t=e.chat_type;E.default.setChatType(t)}if("room_connection_type"in e){const t=e.room_connection_type;E.default.setRoomConnectionType(t)}})),this.paneMain=new v.PaneMain,this.paneFkey=new c.PaneFkey,this.paneInput=new h.PaneInput,this.setInputEvents(),this.paneMonitor=new m.PaneMonitor,this.setMonitorEvents(),this.paneNote=new M.PaneNote,this.setNoteEvents(),this.panes={i:this.paneInput,f:this.paneFkey},this.localizeAll(),this.setEvents()}sendMain(e){const t=E.default.getName();E.default.useAutoNameOnSend()&&(e=t+y.T.t(" : ","Chat")+e);const n=new p.ContentToSendClass(t,p.ContentType.DISPLAY,e);this.comm.send_room(n);const i=p.ContentClass.fromSendData(this.id,n);this.paneMain.addNewItem(i)}sendNote(e){l.default.w("info",`send note : ${e}`);const t=new p.ContentToSendClass(E.default.getName(),p.ContentType.NOTE,e);this.comm.send_room(t)}updateRoomName(e){this.roomName=e,C.UtilDom.setQuery(e),e.length>0?this.updatePageTitle(y.T.t("Room","General")+" "+e):this.updatePageTitle(y.T.t("Login","Login"))}updatePageTitle(e,t=!0){this.pageTitle.length<1&&(this.pageTitle=document.title),document.title=t?e+" - "+this.pageTitle:this.pageTitle+" - "+e}setDialogConfigEvents(){this.dialogConfig.onSetClicked=()=>{this.updateAllConfig()},this.dialogConfig.onResetClicked=()=>{_.AppConfig.resetAll(),this.updateAllConfig(),this.dialogConfig.configToDialog()}}setAppControlEvents(){this.appControl.onConfig=()=>{this.dialogConfig.showDialog()},this.appControl.onLogout=()=>{const e=new p.ContentToSendClass(E.default.getName(),p.ContentType.LOGOFF,"");this.comm.send_room(e),this.comm.leaveRoom()},this.appControl.onShowNote=()=>{var e;!0===(null===(e=this.smallScreenMediaQuery)||void 0===e?void 0:e.matches)&&(E.default.setDisplayStyle("OnlySub"),this.setSplits())},this.appControl.onBackToChat=()=>{var e;!0===(null===(e=this.smallScreenMediaQuery)||void 0===e?void 0:e.matches)&&(E.default.setDisplayStyle("OnlyChat"),this.setSplits())}}setLoginDialogEvents(){this.dialogLogin.onDownloadMain=()=>{const e=f.Util.getIsoModifiedDateTimeString()+".log",t=this.paneMain.getMainLog().join(f.Util.getNewLineCode());S.Downloader.start(e,t)},this.dialogLogin.onDownloadNote=()=>{const e=f.Util.getIsoModifiedDateTimeString()+"_note.log",t=this.paneNote.getNote();S.Downloader.start(e,t)},this.dialogLogin.onLoginClick=e=>{this.loginInfo=e,e.room.length<1&&(e.room=location.hash),E.default.setName(e.name);let t=e;this.comm.open(E.default.getApiKey(),{handleOpen:e=>{this.comm.joinRoom(t,E.default.getRoomConnectionType()).then((()=>{})).catch((e=>{}))},debugLevel:E.default.getDebugLevel()}),this.updateRoomName(e.room),this.paneMonitor.clearMembers(),this.paneMain.goBottom(),this.paneInput.clearAllInput(),this.setSubtitlerStyle()}}setInputEvents(){this.paneInput.setGetFkey((e=>this.paneFkey.getFKey(e))),this.paneInput.setDoOnInput((e=>{const t=new p.ContentToSendClass(E.default.getName(),p.ContentType.MONITOR,e);this.comm.send_room(t)})),this.paneInput.setDoOnEnter((e=>{this.sendMain(e)}))}setMonitorEvents(){this.paneMonitor.setOnNewJoined((e=>{var t;this.paneMain.addMessageMemberAttended(null!==(t=e.name)&&void 0!==t?t:"???")})),this.paneMonitor.setOnLeft((e=>{var t;this.paneMain.addMessageMemberExited(null!==(t=e.name)&&void 0!==t?t:"???")}))}setNoteEvents(){this.paneNote.onUpdate=e=>{this.sendNote(e)}}setSubtitlerStyle(){this.paneInput.focus()}updateAllConfig(){this.paneMain.updateConfig(),this.paneInput.updateConfig(),this.paneMonitor.updateConfig(),this.paneNote.updateConfig(),this.paneFkey.updateConfig()}manageScreenWidth(e){null==e?E.default.setDisplayStyle("Full"):e.matches?(E.default.setDisplayStyle("OnlyChat"),this.paneInput.setupAsNarrowScreen()):E.default.setDisplayStyle("Full"),this.setSplits()}selectWidths(){switch(E.default.getDisplayStyle()){case"Full":return[_.AppConfig.data.misc_pane1_width,_.AppConfig.data.misc_pane2_width];case"OnlyChat":return[100,0];case"OnlySub":return[0,100]}}selectHeights(){return E.default.getIfNarrow()?[100,0]:[_.AppConfig.data.misc_display_input_height,_.AppConfig.data.misc_monitor_height]}setSplits(){const[e,t]=this.selectWidths();e>0?this.pane1.show():this.pane1.hide(),t>0?this.pane2.show():this.pane2.hide(),null==this.splitContainer?this.splitContainer=w.default(["#pane1","#pane2"],{sizes:[e,t],minSize:0,direction:"horizontal",gutterSize:6,onDragEnd:e=>{var t;!0===E.default.getIfNarrow()?null===(t=this.splitContainer)||void 0===t||t.setSizes(this.selectWidths()):(_.AppConfig.data.misc_pane1_width=e[0],_.AppConfig.data.misc_pane2_width=e[1])}}):this.splitContainer.setSizes([e,t]);const[n,i]=this.selectHeights();null==this.splitDisplayMonitor?this.splitDisplayMonitor=w.default(["#display-input","#monitor"],{sizes:[n,i],minSize:0,direction:"vertical",gutterSize:6,onDragEnd:e=>{var t;E.default.getIfNarrow()?null===(t=this.splitDisplayMonitor)||void 0===t||t.setSizes([100,0]):(_.AppConfig.data.misc_display_input_height=e[0],_.AppConfig.data.misc_monitor_height=e[1])}}):this.splitDisplayMonitor.setSizes([n,i])}localizeAll(){this.localize(),this.paneInput.localize(),this.paneMonitor.localize(),this.paneFkey.localize()}onPeerIdAcquired(e){this.id=e}onJoined(){const e=new p.ContentToSendClass(E.default.getName(),p.ContentType.LOGIN,"");this.comm.send_room(e)}onLeft(){if(null==this.dialogLogin)return;if(this.isErrorHandling)return;if(this.dialogLogin.isShown())return;this.dialogLogin.setRoom(this.roomName),this.dialogLogin.setName(E.default.getName()),this.updateRoomName(""),this.paneMonitor.clearMembers();const e=this.paneMain.hasMainLog(),t=this.paneNote.hasNote();this.dialogLogin.showDialog(e,t)}onSomeoneJoined(e){}onSomeoneLeft(e){this.paneMonitor.deleteMember(e)}onReceived(e){const t=g.MemberInfoClass.fromContent(e);let n=!0;if(e.messageType===p.ContentType.LOGIN){const e=this.paneNote.getNote();let t=this.paneNote.getLastSender();t.length<1&&(t=E.default.getName());const n=new p.ContentToSendClass(E.default.getName(),p.ContentType.RESPONSE,t+"\n"+e);this.comm.send_room(n),this.isActive||this.audioNotify.play()}e.messageType===p.ContentType.RESPONSE&&this.paneNote.updateByResponse(e),e.messageType===p.ContentType.DISPLAY&&(t.inputContent="",this.paneMonitor.updateMember(t,e),this.paneMain.addNewItem(e),n=!1,this.isActive||this.audioNotify.play()),e.messageType===p.ContentType.MONITOR&&(t.inputContent=e.messageBody),e.messageType===p.ContentType.NOTE&&this.paneNote.update(e),p.ContentType.LOGOFF in e?(this.paneMonitor.deleteMember(e.senderID),this.isActive||this.audioNotify.play()):n&&this.paneMonitor.updateMember(t,e)}onAuthError(){this.dialogNotify.onOkClick=()=>{this.onLeft()},this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Login failed.","Login"))}onCommunicationError(e){this.isErrorHandling=!0,this.comm.leaveRoom(),this.dialogNotify.onOkClick=()=>{this.isErrorHandling=!1,this.onLeft()};const t=null!=e.message?"\n"+y.T.t("Detail","General")+" : "+e.message:"";this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Communication error.","General")+t)}onSomeError(e){this.isErrorHandling=!0,this.comm.leaveRoom(),this.dialogNotify.onOkClick=()=>{this.isErrorHandling=!1,this.onLeft()};const t=null!=e.message?"\n"+y.T.t("Detail","General")+" : "+e.message:"";this.dialogNotify.showDialog(y.T.t("Error","General"),y.T.t("Communication error.","General")+t)}onPeerError(e){"authentication"===e.type?this.onAuthError():"socket-error"===e.type?this.onCommunicationError(e):this.onSomeError(e)}makeCommEventHandlers(){const e=new r.MekikuCommEvents;return e.onPeerIdAcquired=e=>{this.onPeerIdAcquired(e)},e.onPeerError=e=>{this.onPeerError(e)},e.onJoinedRoom=()=>{this.onJoined()},e.onLeftRoom=()=>{this.onLeft()},e.onReceived=e=>{this.onReceived(e)},e.onSomeoneJoined=e=>{this.onSomeoneJoined(e)},e.onSomeoneLeft=e=>{this.onSomeoneLeft(e)},e.logger=e=>{l.default.w("Comm",e)},e}onBeforeUnload(e){var t;if(!0===(null===(t=this.comm)||void 0===t?void 0:t.isInRoom()))return e.preventDefault(),e.returnValue="Truly exit?","Truly exit?"}onUnload(e){var t;if(!0===(null===(t=this.comm)||void 0===t?void 0:t.isInRoom())){const e=new p.ContentToSendClass(E.default.getName(),p.ContentType.LOGOFF,"");this.comm.send_room(e),this.comm.leaveRoom()}const n=_.AppConfig.getJSON();localStorage.setItem(this.KEY_STORAGE,n)}setEvents(){this.smallScreenMediaQuery=window.matchMedia(this.MEDIA_QUERY_SMALL_SCREEN),this.smallScreenMediaQuery.addEventListener("change",(e=>{this.manageScreenWidth(this.smallScreenMediaQuery)})),this.manageScreenWidth(this.smallScreenMediaQuery),document.addEventListener("visibilitychange",(e=>{document.hidden})),document.addEventListener("keydown",(e=>{"F5"===e.key&&this.comm.isInRoom()&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()),"F1"===e.key&&this.comm.isInRoom()&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation());const t=C.UtilDom.isCommandOrControlPressed(e)&&!e.shiftKey;if(t){const t=e.key.toLowerCase();t in this.panes&&(this.panes[t].focus(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())}"o"===e.key&&t&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()),"s"===e.key&&t&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())}))}localize(){const e=document.getElementsByClassName("l10n");for(const n of e){const e=n.id,i=document.getElementById(e);if(null===i)continue;const o=i.dataset.key,s=i.textContent;var t;if(null!=o)t=o;else{if(null==s){l.default.w("Warning",`app.localize element[${e}] no textContent.`);continue}t=s,i.dataset.key=t}const a=i.dataset.context;if(void 0===a){l.default.w("Warning",`app.localize element[${e}] data-context not exists.`);continue}const r=y.T.t(t,a);i.textContent=r}const n=document.getElementsByClassName("title-l10n");for(const e of n){const t=e.id,n=document.getElementById(t);if(null===n)continue;const i=n.title;if(null===i)continue;const o=n.dataset.context;if(void 0===o)continue;const s=y.T.t(i,o);n.title=s}}}},43:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppConfig=void 0;const i=n(165);class o{constructor(){this._misc_locale="",this.misc_pane1_width=70,this.misc_pane2_width=30,this.misc_display_input_height=65,this.misc_monitor_height=35,this.main_font_size=24,this.input_font_size=20,this.input_parentheses_1="",this.input_parentheses_2="",this.input_parenthesesShift_1="",this.input_parenthesesShift_2="",this.monitor_font_size=14,this.note_font_size=14,this.fkey_font_size=14}getLocale(){return""===this._misc_locale?i.T.getBrowserLocale():this._misc_locale}setLocale(e){e===i.T.getBrowserLocale()?this._misc_locale="":this._misc_locale=e}getParentheses1_Default(){return i.T.t("“","Config|Input")}getParentheses2_Default(){return i.T.t("”","Config|Input")}getParenthesesShift1_Default(){return i.T.t("(","Config|Input")}getParenthesesShift2_Default(){return i.T.t(")","Config|Input")}getParentheses1(){return""===this.input_parentheses_1?this.getParentheses1_Default():this.input_parentheses_1}setParentheses1(e){if(e===this.getParentheses1_Default()){if(""===this.input_parentheses_1)return!1;this.input_parentheses_1=""}else{if(this.input_parentheses_1===e)return!1;this.input_parentheses_1=e}return!0}getParentheses2(){return""===this.input_parentheses_2?this.getParentheses2_Default():this.input_parentheses_2}setParentheses2(e){if(e===this.getParentheses2_Default()){if(""===this.input_parentheses_2)return!1;this.input_parentheses_2=""}else{if(this.input_parentheses_2===e)return!1;this.input_parentheses_2=e}return!0}getParenthesesShift1(){return""===this.input_parenthesesShift_1?this.getParenthesesShift1_Default():this.input_parenthesesShift_1}setParenthesesShift1(e){if(e===this.getParenthesesShift1_Default()){if(""===this.input_parenthesesShift_1)return!1;this.input_parenthesesShift_1=""}else{if(this.input_parenthesesShift_1===e)return!1;this.input_parenthesesShift_1=e}return!0}getParenthesesShift2(){return""===this.input_parenthesesShift_2?this.getParenthesesShift2_Default():this.input_parenthesesShift_2}setParenthesesShift2(e){if(e===this.getParenthesesShift2_Default()){if(""===this.input_parenthesesShift_2)return!1;this.input_parenthesesShift_2=""}else{if(this.input_parenthesesShift_2===e)return!1;this.input_parenthesesShift_2=e}return!0}static get data(){return void 0===o.configNow&&(o.configNow=new o),o.configNow}static tryApplyNewData(e){for(var t of(this.configNow=new o,Object.keys(e)))t in this.configNow&&typeof this.configNow[t]==typeof e[t]&&(this.configNow[t]=e[t]);return!0}static trySetJSON(e){const t=JSON.parse(e);return this.tryApplyNewData(t)}static getJSON(){return JSON.stringify(o.data)}static resetAll(){o.configNow=new o}}t.AppConfig=o,o.configNow=void 0},144:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.ContentClass=t.ContentToSendClass=void 0;const i=n(882);class o{constructor(e,t,n){this.seqCount=++o.counter,this.sendTimeCount=Date.now(),this.senderName=e,this.messageType=t,this.messageBody=n}}t.ContentToSendClass=o,o.counter=0,t.ContentClass=class{constructor(){this.seqCount=0,this.sendTimeCount=0,this.senderName="",this.messageType="",this.messageBody="",this.senderID="",this.receiveTimeCount=Date.now()}static fromAny(e,t){return null==t?null:i.Util.isNumber(t.seqCount)&&i.Util.isNumber(t.sendTimeCount)&&i.Util.isString(t.senderName)&&i.Util.isString(t.messageType)&&i.Util.isString(t.messageBody)?(t.receiveTimeCount=Date.now(),t.senderID=e,t):null}static fromSendData(e,t){const n=t;return n.senderID=e,n.receiveTimeCount=t.sendTimeCount,n}},t.ContentType={LOGIN:"L",RESPONSE:"R",DISPLAY:"D",MONITOR:"M",NOTE:"N",LOGOFF:"F"}},795:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DialogConfig=void 0;const o=n(165),s=n(43),a=n(359),r=i(n(110));t.DialogConfig=class{constructor(){this.container=document.getElementById("config-container"),this.pane=document.getElementById("config"),this.buttonReset=document.getElementById("config-reset"),this.buttonOK=document.getElementById("config-button-ok"),this.buttonCancel=document.getElementById("config-button-cancel"),this.onSetClicked=()=>{},this.onResetClicked=()=>{},this.setTitle(o.T.t("Config","Config")),this.buttonReset.addEventListener("click",(e=>{this.onResetClicked()})),this.buttonOK.addEventListener("click",(e=>{this.dialogToConfig(),this.hideDialog(),this.onSetClicked()})),this.buttonCancel.addEventListener("click",(e=>{this.hideDialog()}))}setTitle(e){}showDialog(){this.configToDialog(),a.UtilDom.show(this.container)}hideDialog(){a.UtilDom.hide(this.container)}configToDialog(){const e=this.pane.getElementsByTagName("input"),t=e.length;for(var n=0;n<t;n++){const t=e[n];if(!t.id.startsWith("config_"))continue;const o=t.id.substr(7);if(null!=s.AppConfig.data[o])"text"===t.type||"number"===t.type||"color"===t.type?e[n].value=s.AppConfig.data[o].toString():"checkbox"===t.type?!0===s.AppConfig.data[o]?e[n].checked=!0:!1===s.AppConfig.data[o]?e[n].checked=!1:r.default.w("Warning",`configToDialog checkbox item --- not boolean [${t.id}]`):r.default.w("Warning",`configToDialog type not found id:${o}`);else if(null!=s.AppConfig.data[t.name]){const o=s.AppConfig.data[t.name];if("radio"===t.type){var i=!1;switch(typeof o){case"string":i=o===t.value;break;case"number":i=o===Number(t.value);break;case"boolean":i=o===("true"===t.value.toLowerCase())}i&&(e[n].checked=!0)}else r.default.w("Warning",`configToDialog type not found name:${t.name} (id:${t.id})`)}else r.default.w("Warning",`configToDialog assign failed id:${t.id} name:${t.name}`)}}dialogToConfig(){const e=this.pane.getElementsByTagName("input"),t=e.length;for(var n=0;n<t;n++)if(e[n].id.startsWith("config_")){var i="";if("radio"===e[n].type){if(!e[n].checked)continue;i=e[n].name}else i=e[n].id.substr(7);if(""===i||void 0!==s.AppConfig.data[i])if("string"==typeof s.AppConfig.data[i]||s.AppConfig.data[i]instanceof String)s.AppConfig.data[i]!==e[n].value&&(s.AppConfig.data[i]=e[n].value);else if("number"==typeof s.AppConfig.data[i]||s.AppConfig.data[i]instanceof Number){const t=Number(e[n].value);if(null==t)continue;s.AppConfig.data[i]!==t&&(s.AppConfig.data[i]=t)}else"boolean"==typeof s.AppConfig.data[i]||s.AppConfig.data[i]instanceof Boolean?"checkbox"===e[n].type?s.AppConfig.data[i]!==e[n].checked&&(s.AppConfig.data[i]=e[n].checked):r.default.w("Warning",`config [${i}] matched non-checkbox input (id=${e[n].id})`):r.default.w("Warning",`configToDialog assign failed : [${e[n].id}]`);else r.default.w("Warning",`dialogToConfig not found : key=${i} element:${e[n].id}`)}}}},222:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(359),s=i(n(487));t.default=class{constructor(){this.dialogLogin=document.getElementById("login"),this.roomRow=document.getElementById("loginTable_roomRow"),this.nameRow=document.getElementById("loginTable_nameRow"),this.passRow=document.getElementById("loginTable_passRow"),this.roomInput=document.getElementById("login-input-room"),this.nameInput=document.getElementById("login-input-name"),this.passInput=document.getElementById("login-input-pass"),this.buttonLogin=document.getElementById("login-button"),this.downloadPane=document.getElementById("loginDialog_log_download_pane"),this.buttonDownload=document.getElementById("loginDialog_log_download"),this.buttonDownloadNote=document.getElementById("loginDialog_note_download"),this.loginCondition=0,this.onLoginClick=e=>{},this.onDownloadMain=()=>{},this.onDownloadNote=()=>{},this.setEvents(),this.updateState()}setLoginCondition(e){this.loginCondition=e,this.updateState()}setEvents(){this.buttonLogin.addEventListener("click",(e=>{const t=new s.default;t.room=this.roomInput.value,t.name=this.nameInput.value,t.pass=this.passInput.value,this.hideDialog(),this.onLoginClick(t)})),this.buttonDownload.addEventListener("click",(e=>{this.onDownloadMain()})),this.buttonDownloadNote.addEventListener("click",(e=>{this.onDownloadNote()})),this.dialogLogin.addEventListener("change",(e=>{this.updateState()})),this.dialogLogin.addEventListener("input",(e=>{this.updateState()})),this.dialogLogin.addEventListener("paste",(e=>{this.updateState()}))}updateState(){!1===o.UtilDom.isDisplayed(this.roomRow)&&!1===o.UtilDom.isDisplayed(this.nameRow)&&!1===o.UtilDom.isDisplayed(this.passRow)&&(this.buttonLogin.disabled=!1);var e=!0;o.UtilDom.isDisplayed(this.roomRow)&&(this.roomInput.value.length<1&&(e=!1),this.roomInput.validationMessage.length>0&&(e=!1)),o.UtilDom.isDisplayed(this.nameRow)&&this.nameInput.value.length<1&&(e=!1),this.loginCondition<1&&(e=!1),this.buttonLogin.disabled=!e}setRoom(e){this.roomInput.value=e}setName(e){this.nameInput.value=e}showDialog(e=!1,t=!1){!0===e?o.UtilDom.displayOn(this.buttonDownload):o.UtilDom.displayOff(this.buttonDownload),!0===t?o.UtilDom.displayOn(this.buttonDownloadNote):o.UtilDom.displayOff(this.buttonDownloadNote),o.UtilDom.show(this.dialogLogin),this.updateState(),this.focusMe()}isShown(){return o.UtilDom.isShown(this.dialogLogin)}focusMe(){const e=o.UtilDom.isDisplayed(this.roomRow),t=o.UtilDom.isDisplayed(this.nameRow);e?this.roomInput.focus():t?this.nameInput.focus():this.buttonLogin.focus()}hideDialog(){o.UtilDom.hide(this.dialogLogin)}showRoom(){this.roomInput.required=!0,o.UtilDom.displayOn(this.roomRow,"table-row")}hideRoom(){this.roomInput.required=!1,o.UtilDom.displayOff(this.roomRow)}showName(){this.nameInput.required=!0,o.UtilDom.displayOn(this.nameRow,"table-row")}hideName(){this.nameInput.required=!1,o.UtilDom.displayOff(this.nameRow)}showPass(){this.passInput.required=!0,o.UtilDom.displayOn(this.passRow,"table-row")}hidePass(){this.passInput.required=!1,o.UtilDom.displayOff(this.passRow)}}},263:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.dialog=document.getElementById("notify"),this.title=document.getElementById("notify-title"),this.message=document.getElementById("notify-message"),this.buttonPane=document.getElementById("notify-buttons"),this.okButton=document.getElementById("notify-ok-button"),this.onOkClick=()=>{},this.okButton.addEventListener("click",(()=>{this.hideDialog(),this.onOkClick(),this.resetOkEvents()}))}resetOkEvents(){this.onOkClick=()=>{}}showDialog(e,t){this.title.textContent=e,this.message.textContent=t,i.UtilDom.show(this.dialog)}hideDialog(){i.UtilDom.hide(this.dialog)}}},580:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Downloader=void 0;class n{constructor(){}static start(e,t){this.dlLink.download=e,this.dlLink.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),this.dlLink.click()}}t.Downloader=n,n.dlLink=document.getElementById("file-download"),t.default=class{constructor(e){this.onAbort=(e,t)=>{},this.onError=(e,t)=>{},this.onLoad=(e,t)=>{},this.opener=document.getElementById(e),this.opener.onchange=e=>{var t;if(1===(null===(t=this.opener.files)||void 0===t?void 0:t.length)){const e=new FileReader,t=this.opener.files[0];e.onabort=e=>{this.onAbort(e,t)},e.onerror=e=>{this.onError(e,t)},e.onload=e=>{this.onLoad(e,t)},e.readAsText(t)}}}openDialogAndReadFile(e){null!=e&&(this.opener.accept=e),this.opener.click()}}},607:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(752));document.addEventListener("DOMContentLoaded",(()=>{new o.default}))},110:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(882);t.default=class{static w(e,t){const n=i.Util.getNowUTCTimeString();console.log(`${n} [${e}] ${t}`)}}},487:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.room="",this.name="",this.pass=""}static clone(e){const t=new n;return t.room=e.room,t.name=e.name,t.pass=e.pass,t}}t.default=n},65:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MekikuCommEvents=void 0;const o=i(n(110)),s=n(144),a=i(n(487)),r=n(882);t.MekikuCommEvents=class{constructor(){this.onPeerIdAcquired=e=>{},this.onPeerError=e=>{},this.onReceived=e=>{},this.onJoinedRoom=()=>{},this.onLeftRoom=()=>{},this.onSomeoneJoined=e=>{},this.onSomeoneLeft=e=>{},this.logger=e=>{}}};class l{constructor(){this.debugLevel=2,this.handleOpen=e=>{}}}t.default=class{constructor(e){this.onPeerIdAcquired=e=>{},this.onPeerError=e=>{},this.onReceived=e=>{},this.onJoinedRoom=()=>{},this.onLeftRoom=()=>{},this.onSomeoneJoined=e=>{},this.onSomeoneLeft=e=>{},this.logger=e=>{},null!=e&&(this.onPeerIdAcquired=e.onPeerIdAcquired,this.onPeerError=e.onPeerError,this.onJoinedRoom=e.onJoinedRoom,this.onLeftRoom=e.onLeftRoom,this.onReceived=e.onReceived,this.onSomeoneJoined=e.onSomeoneJoined,this.onSomeoneLeft=e.onSomeoneLeft,this.logger=e.logger)}isOpen(){var e;return!0===(null===(e=this.peer)||void 0===e?void 0:e.open)}getInfo(){return null==this.info?void 0:a.default.clone(this.info)}isInRoom(){return null!=this.info}open(e,t){var n;!0===(null===(n=this.peer)||void 0===n?void 0:n.open)&&this.peer.destroy(),this.openOption={...new l,...t};const i={key:e,debug:this.openOption.debugLevel};null!=this.openOption.id?this.peer=new Peer(this.openOption.id,i):this.peer=new Peer(i),this.setPeerEvents(this.peer)}async joinRoom(e,t="sfu"){if(null==this.peer)throw o.default.w("Error","peer is null."),new Error("peer is null");if(!r.Util.isRoomNameLegit(e.room))throw o.default.w("Error",`Illegal room name:[${e.room}]`),new Error("Illegal room name");const n="sfu"===(i=t)||"mesh"===i?i:"sfu";var i;const s=await this.makeRoomName(e.room,e.pass),l=this.peer.joinRoom(s,{mode:n});if(null==l)throw o.default.w("Error","joinRoom failed."),new Error("joinRoom failed.");this.info=a.default.clone(e),this.room=l,this.setRoomEvents(this.room)}async makeRoomName(e,t){return""===t?e:e+"*"+await r.Util.digestMessage(t)}leaveRoom(){null!=this.room&&this.room.close()}send_room(e){var t,n;null===(t=this.info)||void 0===t||t.name,null!=this.room&&(null===(n=this.room)||void 0===n||n.send(e))}setPeerEvents(e){e.on("open",(e=>{var t;null!=(null===(t=this.openOption)||void 0===t?void 0:t.handleOpen)&&(this.openOption.handleOpen(e),delete this.openOption),this.onPeerIdAcquired(e)})),e.on("close",(()=>{})),e.on("connection",(e=>{})),e.on("error",(e=>{o.default.w("Error",`peer error (${e.type}) <${e.message}>`),this.onPeerError(e)}))}setRoomEvents(e){e.on("open",(()=>{this.onJoinedRoom()})),e.on("peerJoin",(e=>{this.onSomeoneJoined(e)})),e.on("peerLeave",(e=>{this.onSomeoneLeft(e)})),e.on("data",(({src:e,data:t})=>{Date.now();const n=s.ContentClass.fromAny(e,t);null!=n&&this.onReceived(n)})),e.on("close",(()=>{var e;delete this.room,delete this.info,null===(e=this.peer)||void 0===e||e.destroy(),this.onLeftRoom()}))}}},877:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemberManager=t.MemberInfoClass=void 0;const o=i(n(110)),s=n(441);class a{constructor(e){this.id=e,this.lastReceived=Date.now(),this.lastSequence=0}static fromContent(e){const t=new a(e.senderID);return t.name=e.senderName,t.lastReceived=e.sendTimeCount,t.lastSequence=e.seqCount,t}}t.MemberInfoClass=a;class r{constructor(){this.members=[],this.colorManager=new s.ColorManager}getCount(){return this.members.length}getColor(e){const t=this.colorManager.color(e);if(null!=t)return s.ColorManager.toString(t)}getMember(e){const t=this.members.find((t=>t.id===e));if(null!=t)return{...t}}enumerateMembers(){return this.members.map((e=>{var t;return null!==(t=e.name)&&void 0!==t?t:"?"}))}update(e){var t,n;const i=this.members.findIndex((t=>t.id===e.id));if(i<0)return this.colorManager.regist(e.id),this.members.push(e),{v1:-1,v2:e};{const s=this.members[i];e.lastSequence!==s.lastSequence+1&&o.default.w("Warning",`Member [${e.id}](${e.name}) seq jump from ${s.lastSequence} to ${e.lastSequence}`);const a=null!==(n=null!==(t=e.inputContent)&&void 0!==t?t:s.inputContent)&&void 0!==n?n:"",r={...e,inputContent:a};return this.members=this.members.map((t=>t.id===e.id?r:t)),{v1:i,v2:r}}}unregist(e){this.colorManager.unregist(e);const t=this.members.findIndex((t=>t.id===e));if(t<0)return{v1:t,v2:null};const n=this.members[t];return this.members=this.members.filter((t=>t.id!==e)),{v1:t,v2:n}}clear(){this.colorManager.clear(),this.members=[]}static get data(){return void 0===r.instance&&(r.instance=new r),r.instance}}t.MemberManager=r,r.instance=void 0},90:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.pane=document.getElementById("pane1")}show(){i.UtilDom.displayOn(this.pane,"flex")}hide(){i.UtilDom.displayOff(this.pane)}}},152:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(359);t.default=class{constructor(){this.pane=document.getElementById("pane2")}show(){i.UtilDom.displayOn(this.pane,"flex")}hide(){i.UtilDom.displayOff(this.pane)}}},478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.control=document.getElementById("control"),this.back=document.getElementById("appBackToChat"),this.config=document.getElementById("appConfig"),this.logout=document.getElementById("appLogout"),this.controlChat=document.getElementById("controlOnChat"),this.showNoteChat=document.getElementById("appShowNoteOnChat"),this.configChat=document.getElementById("appConfigOnChat"),this.logoutChat=document.getElementById("appLogoutOnChat"),this.onConfig=()=>{},this.onLogout=()=>{},this.onShowNote=()=>{},this.onBackToChat=()=>{},this.back.addEventListener("click",(e=>{this.onBackToChat()})),this.config.addEventListener("click",(e=>{this.onConfig()})),this.logout.addEventListener("click",(e=>{this.onLogout()})),this.showNoteChat.addEventListener("click",(e=>{this.onShowNote()})),this.configChat.addEventListener("click",(e=>{this.onConfig()})),this.logoutChat.addEventListener("click",(e=>{this.onLogout()}))}}},771:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaneFkey=void 0;const i=n(43),o=n(882),s=n(165);t.PaneFkey=class{constructor(){this.pane=document.getElementById("fkey"),this.titlebar=document.getElementById("fkey-title"),this.outerTable=document.getElementById("fkey-table"),this.localize(),this.fkeys=[document.getElementById("fkey01"),document.getElementById("fkey02"),document.getElementById("fkey03"),document.getElementById("fkey04"),null,null,null,null,null],this.configToScreen()}getName(){return"PaneFkey"}applyFont(e){e.style.fontSize=i.AppConfig.data.fkey_font_size+"pt"}configToScreen(){const e=this.outerTable.getElementsByClassName("fkey-label");for(var t of e){const e=document.getElementById(t.id);null!==e&&this.applyFont(e)}const n=this.outerTable.getElementsByClassName("fkey-input");for(var i of n){const e=document.getElementById(i.id);null!==e&&this.applyFont(e)}const o=this.outerTable.getElementsByClassName("fkey-text-readonly");for(var s of o){const e=document.getElementById(s.id);null!==e&&this.applyFont(e)}}getFKey(e){if(e>=0&&e<this.fkeys.length){const t=this.fkeys[e];if(null!=t)return t.value}return""}localize(){this.setTitle(s.T.t("Shortcut","Fkey")+o.Util.getShortcutParenthesized("F"))}setTitle(e){this.titlebar.textContent=e}updateConfig(){this.configToScreen()}setPaneToConfig(){}focus(){var e;null===(e=this.fkeys[0])||void 0===e||e.focus()}}},150:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PaneInput=void 0;const o=n(43),s=n(359),a=n(165),r=i(n(326));t.PaneInput=class{constructor(){this.pane=document.getElementById("input"),this.input1Vjs=document.getElementById("input1"),this.getFkey=e=>"",this.doOnInput=e=>{},this.lastSendInput="",this.doOnEnter=e=>{},this.localize(),this.input1Vjs.addEventListener("input",(e=>{this.onInput(this.input1Vjs.value)})),this.input1Vjs.addEventListener("keydown",(e=>{this.onType(this.input1Vjs,e)})),this.configToScreen()}getName(){return"PaneInput"}setGetFkey(e){this.getFkey=t=>e(t)}setDoOnInput(e){this.doOnInput=t=>e(t)}onInput(e){e!==this.lastSendInput&&(this.lastSendInput=e,this.doOnInput(e))}setDoOnEnter(e){this.doOnEnter=t=>e(t)}onEnter(e){this.doOnEnter(e)}onType(e,t){if(t.keyCode!==s.UtilDom.KEY_CTRL){if(t.keyCode===s.UtilDom.KEY_ENTER)""!==e.value&&e.value!==this.makeInitialPhrase()&&(this.onEnter(e.value),this.clearInput(e)),t.preventDefault(),t.stopImmediatePropagation();else if(t.keyCode===s.UtilDom.KEY_ESC)this.clearInput(e),t.preventDefault(),t.stopImmediatePropagation();else{const n=s.UtilDom.getCtrlOrFKeyNumber(t)-1;if(n>=0&&n<7){const i=this.getFkey(n);i.length>0&&this.replacePart(e,i),t.preventDefault(),t.stopImmediatePropagation()}else 7===n&&(!0!==t.shiftKey?this.enclose(e,o.AppConfig.data.getParentheses1(),o.AppConfig.data.getParentheses2()):this.enclose(e,o.AppConfig.data.getParenthesesShift1(),o.AppConfig.data.getParenthesesShift2()),t.preventDefault(),t.stopImmediatePropagation())}this.onInput(e.value)}}clearAllInput(){this.clearInput(this.input1Vjs)}clearInput(e){r.default.getIfNarrow()&&!0!==r.default.useAutoNameOnSend()?e.value=this.makeInitialPhrase():e.value=""}makeInitialPhrase(){return r.default.getName()+a.T.t(" : ","Chat")}setupAsNarrowScreen(){""===this.input1Vjs.value&&this.clearInput(this.input1Vjs)}configToScreen(){this.input1Vjs.style.fontSize=o.AppConfig.data.main_font_size+"pt"}setPaneToConfig(){}replacePart(e,t){const n=e.selectionStart||0,i=e.selectionEnd||0,o=e.value.substring(0,n),s=e.value.substring(i);e.value=o+t+s;const a=n+t.length;e.blur(),e.setSelectionRange(a,a),e.focus()}enclose(e,t,n){const i=e.selectionStart||0,o=e.selectionEnd||0,s=e.value.length;e.value=t+e.value+n;var a=i+t.length,r=o+t.length;i===o&&o===s&&(a+=n.length,r+=n.length),e.blur(),e.setSelectionRange(a,r),e.focus()}updateConfig(){this.configToScreen()}focus(){this.input1Vjs.focus()}localize(){this.input1Vjs.placeholder=a.T.t("Type your message here, then hit enter.","Input")}}},900:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaneMain=void 0;const i=n(43),o=n(144),s=n(877),a=n(165);t.PaneMain=class{constructor(){this.pane=document.getElementById("display"),this.contents=[],this.configToScreen()}getName(){return"PaneMain"}getMainLog(){return this.contents.map((e=>e.messageBody))}hasMainLog(){return this.contents.length>0}makeSpan(e){const t=document.createElement("span");return t.textContent=e,t}makeAnchor(e,t){const n=document.createElement("a");return n.href=e,n.textContent=t||e,n.rel="noreferrer noopener",n.target="_blank",n}makeMessageElement(e){this.contents.push(e);const t=document.createElement("p");t.classList.add("message");const n=new RegExp("https?://[A-Za-z0-9\\-._~:/?#[\\]@!$&'()*+,;=%]+","g"),i=e.messageBody;let o=n.exec(i),s=0;for(;null!==o;)o.index>s&&t.appendChild(this.makeSpan(i.substring(s,o.index))),t.appendChild(this.makeAnchor(o[0])),s=n.lastIndex,o=n.exec(i);return t.appendChild(this.makeSpan(i.substring(s))),t}addItemToDisplayPane(e){const t=this.pane.scrollTop+this.pane.clientHeight-this.pane.scrollHeight;this.pane.appendChild(e),t>=-this.pane.clientHeight&&this.goBottom()}goBottom(){this.pane.scrollTop=this.pane.scrollHeight-this.pane.clientHeight}addMyNewItem(e){const t=this.makeMessageElement(e);this.addItemToDisplayPane(t)}addMessageMemberAttended(e){const t=new o.ContentClass;t.senderName=e,t.messageType=o.ContentType.LOGIN,t.messageBody=`( ${a.T.t("login","Chat")} : ${e} )`;const n=this.makeMessageElement(t);this.addItemToDisplayPane(n)}addMessageMemberExited(e){const t=new o.ContentClass;t.senderName=e,t.messageType=o.ContentType.LOGOFF,t.messageBody=`( ${a.T.t("logout","Chat")} : ${e} )`;const n=this.makeMessageElement(t);this.addItemToDisplayPane(n)}addNewItem(e){const t=this.makeMessageElement(e),n=s.MemberManager.data.getColor(e.senderID);null!=n&&""!==n&&(t.style.color=n),this.addItemToDisplayPane(t)}configToScreen(){this.pane.style.fontSize=i.AppConfig.data.main_font_size+"pt"}updateConfig(){this.configToScreen()}setPaneToConfig(){}focus(){}}},702:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaneMonitor=void 0;const i=n(43),o=n(877),s=n(165),a=n(359),r=n(144);t.PaneMonitor=class{constructor(){this.onMemberNewJoined=e=>{},this.onMemberLeft=e=>{},this.pane=document.getElementById("monitor"),this.titlebar=document.getElementById("monitor-title"),this.table=document.getElementById("monitorTable"),this.fontChecker=document.getElementById("monitorFontChecker"),this.header1=document.getElementById("monitorHeader1"),this.header2=document.getElementById("monitorHeader2"),this.memberList=document.getElementById("member-list"),this.IX_NAME=0,this.IX_INPUT=1,this.N_COLUMNS=2,this.localize(),this.configToScreen()}getName(){return"PaneMonitor"}setOnNewJoined(e){this.onMemberNewJoined=t=>e(t)}setOnLeft(e){this.onMemberLeft=t=>e(t)}updateMember(e,t){let n=o.MemberManager.data.update(e).v1;n<0&&(this.addRow(),this.updateMemberList(),n=o.MemberManager.data.getCount()-1,t.messageType===r.ContentType.LOGIN&&this.onMemberNewJoined(e)),this.updateRow(n,e)}deleteMember(e){const t=o.MemberManager.data.unregist(e);t.v1>=0&&(this.removeRow(t.v1+1),this.updateMemberList(),null!=t.v2&&this.onMemberLeft(t.v2))}clearMembers(){o.MemberManager.data.clear(),this.clearRows(),this.updateMemberList()}updateMemberList(){if(o.MemberManager.data.getCount()<1)this.memberList.textContent=s.T.t("(no attendance)","Monitor");else{const e=o.MemberManager.data.enumerateMembers();this.memberList.textContent=e.join(" ")}}configToScreen(){this.table.style.fontSize=i.AppConfig.data.monitor_font_size+"pt",this.fontChecker.style.fontSize=i.AppConfig.data.monitor_font_size+"pt"}clearRows(){for(;this.table.rows[1];)this.table.deleteRow(1)}addRow(){const e=this.table.insertRow(-1);this.addColumns(e,this.N_COLUMNS)}addColumns(e,t){for(var n=0;n<t;n++){const t=e.insertCell(-1),n=document.createTextNode("");t.appendChild(n)}}removeRow(e){this.table.deleteRow(e)}updateRow(e,t){const n=this.table.rows[e+1],i=n.cells[this.IX_NAME].firstChild,o=null!=t.name?t.name:"noname";i&&(i.data=o),n.cells[this.IX_NAME].title=t.id;const s=n.cells[this.IX_INPUT].firstChild,a=void 0===t.inputContent?"":t.inputContent;if(s){const e=this.seekTextStartForShowAll(a);var r=a.substr(e);s.data=r}this.updateStates()}seekTextStartForShowAll(e){const t=e.length,n=a.UtilDom.getWidth(this.header2);this.fontChecker.textContent=e;var i=a.UtilDom.getWidth(this.fontChecker);if(i<=n)return 0;for(var o=Math.floor(t/2),s=t,r=1,l=0;l<10;l++){if(this.fontChecker.textContent=e.substr(t-o,o),(i=a.UtilDom.getWidth(this.fontChecker))>n?o<s&&(s=o):o>r&&(r=o),s===r+1)return t-r;o=Math.floor((s+r)/2)}return t-r}updateStates(){}updateConfig(){this.configToScreen()}localize(){this.setTitle(s.T.t("Input Monitor","Monitor"))}setTitle(e){this.titlebar.textContent=e}focus(){}}},914:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaneNote=void 0;const i=n(43),o=n(165);t.PaneNote=class{constructor(){this.pane=document.getElementById("note"),this.titlebar=document.getElementById("note-title"),this.noteText=document.getElementById("note-text"),this.noteStateText=document.getElementById("note-state-text"),this.lastSenderName="",this.onUpdate=e=>{},this.setEvent(),this.localize(),this.configToScreen(),this.updateState()}getName(){return"PaneNote"}hasNote(){return this.noteText.value.length>0}getNote(){return this.noteText.value}getLastSender(){return this.lastSenderName}setEvent(){this.noteText.addEventListener("input",(e=>{var t;this.onUpdate(null!==(t=this.noteText.value)&&void 0!==t?t:""),this.updateState(o.T.t("(yourself)","Note"))}))}updateNote(e,t){const n=this.noteText.selectionStart,i=this.noteText.selectionEnd;this.noteText.value=e,this.updateState(t),this.lastSenderName=t,this.noteText.selectionStart=n,this.noteText.selectionEnd=i}update(e){this.updateNote(e.messageBody,e.senderName)}updateByResponse(e){const t=e.messageBody,n=t.indexOf("\n");n<0||n>=t.length-1||this.updateNote(t.substring(n+1),t.substring(0,n))}updateState(e){this.noteStateText.textContent=e?`${o.T.t("Last update","Note")} : ${e}`:o.T.t("Last update","Note")+" : "}applyStyle(e){e.style.fontSize=i.AppConfig.data.note_font_size+"pt"}configToScreen(){this.applyStyle(this.noteText)}updateConfig(){this.configToScreen()}localize(){this.setTitle(o.T.t("Shared Note","Note"))}setTitle(e){this.titlebar.textContent=e}setPaneToConfig(){}focus(){this.noteText.focus()}}},165:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.T=void 0;const i=n(882);class o{constructor(){this._locale="",this._failed=[],this._dicts={},this._dict=null,this.initDict()}static data(){return null===o._instance&&(o._instance=new o),o._instance}static t(e,t){const n=o.data().getPhrase(e,t);return""===n?e:(i.Util.isMac()&&n.replace("Ctrl+","Cmd+"),n)}static a(e,t){return o.data().analyze(e,t)}static matchLocale(e){return o.data()._matchLocale(e)}static getBrowserLocale(){return window.navigator.languages&&window.navigator.languages[0]||window.navigator.language}static setLocale(e){return o.data().setInnerLocale(e),!0}static getLocales(){var e=["en"];for(var t of Object.keys(o.data()._dicts))e.push(t);e.sort();var n=[];for(var t of e){if("en"===t){n.push({v1:"en",v2:"English"});continue}const e=o.data()._dicts[t];if(void 0===e)continue;const i=e.MyName;if(void 0===i)continue;const s=i.English;void 0!==s&&n.push({v1:t,v2:s})}return n}static getFails(){return o.data().getAllFails()}_matchLocale(e){if("en"===e||"en-US"===e)return"";if(void 0!==this._dicts[e])return e;const t=e.indexOf("-");if(t<=0)return"";const n=e.substr(0,t);return void 0!==this._dicts[n]?n:""}setInnerLocale(e){this._locale=this._matchLocale(e),""===this._locale?this._dict=null:this._dict=this._dicts[this._locale]}trySetLocale(e){if("en"===e||"en-US"===e)return this._locale="",this._dict=null,!0;const t=this._dicts[e];if(null!=t)return this._locale=e,this._dict=t,!0;const n=e.indexOf("-");if(n<=0)return!1;const i=e.substr(0,n),o=this._dicts[i];return null!=o&&(this._locale=i,this._dict=o,!0)}analyze(e,t){if(null===this._dict)return`dict===null. return [${e}]`;const n=this._dict[t];if(void 0===n)return`dict[${t}] is undef.`;const i=n[e];return void 0===i?`phrases[${e}] is undef.`:`found [${i}]`}getPhrase(e,t){if(null===this._dict)return e;const n=this._dict[t];if(void 0===n)return this._failed.push({v1:e,v2:t}),e;const i=n[e];return void 0===i?(this._failed.push({v1:e,v2:t}),e):i}getAllFails(){return this._failed}initDict(){this._dicts.ja={MyName:{English:"日本語"},General:{"mekiku-web":"web版mekiku",OK:"OK",Cancel:"キャンセル",Error:"エラー",Warning:"警告","all files":"全てのファイル","file name":"ファイル名",Subtitler:"入力者",Viewer:"閲覧者","Number of Viewers":"閲覧者数","Error occured on file access.\nIf another application is using it, first quit it.":"ファイルへのアクセスでエラーが発生しました。\n他のプログラムでファイルを開いていたら、そちらを終了してください。","Communication error.":"通信エラーです。",Detail:"詳細","Internet Explorer and old version of Microsoft Edge are not supported.":"Internet Explorerおよび旧版のMicrosoft Edgeでは利用できません。",Note:"メモ表示",Chat:"チャット表示"},Input:{"Input Window":"入力ウインドウ","Type your message here, then hit enter.":"メッセージを入力して、Enterキーで送信"},Chat:{Chat:"連絡窓",Start:"カウントダウン開始",Halt:"カウントダウン停止",Reset:"残り時刻リセット","Increase Timer By A Minute":"タイマー1分延長","Decrease Timer By A Minute":"タイマー1分短縮","0:00":"0：00","30 seconds to next turn.":"30秒前です。"," : ":"／","It's new turn now.":"交代です。","Timer started. Next ":"タイマーを開始しました。通知間隔 ","Timer halted.":"タイマーを停止しました。",login:"ログイン","New viewer":"閲覧者がログイン",logout:"ログアウト","A viewer left":"閲覧者が退室"},Monitor:{"Input Monitor":"入力モニター",name:"名前","current input window":"入力中の内容",connect:"接続","(no attendance)":"（参加者なし）"},PFT:{"PFT (Pre-Formatted Text)":"前ロール","Open (Ctrl+O)":"開く (Ctrl+O)","Save As (Ctrl+S)":"名前をつけて保存 (Ctrl+S)","Next Comment (Ctrl+down)":"次のコメント行へジャンプ (Ctrl+↓)","Previous Comment (Ctrl+up)":"前のコメント行へジャンプ (Ctrl+↑)","Next Window (Ctrl+right)":"次のウインドウへ移動 (Ctrl+→)","Previous Window (Ctrl+left)":"前のウインドウへ移動 (Ctrl+←)","PFT files":"前ロールファイル","UTF-8 PFT files":"UTF-8前ロールファイル","Unicode PFT files":"Unicode前ロールファイル","text files":"テキストファイル"},PftMon:{"PFT Monitor":"前ロールモニター","'s Pre-Formatted Text":"の前ロールをモニター中"},Fkey:{Shortcut:"Fキー","Parenthesize all":"行全体をかっこでくくる",Undo:"入力部へ1回分引く(undo)","(Not available)":"（使用不能）"},Note:{"Shared Note":"共有メモ","Last update":"更新者","(yourself)":"（自分）"},Log:{Log:"ログ"},Login:{Login:"ログイン","LAN card":"LANカード",Name:"名前",Channel:"チャンネル",Group:"班","The network port is occupied by other application.\nSelect another channel and login.":"同じネットワークポートが別のプログラムに使われています。\n別チャンネルを指定して再ログインしてみてください。","Network error occurs. Make sure network connection.":"ネットワークエラーです。接続を再確認してください。","(No Network Available)":"（接続可能なLANがありません）",Room:"ルーム",Viewer:"利用者・閲覧者",Subtitler:"入力者（要約筆記者）",Password:"パスワード","Login failed.":"ログインに失敗しました。",Logout:"ログアウト"},Config:{Config:"設定"},"Config|General":{"Font Size":"文字の大きさ","Font Name":"フォント名","Font Color":"文字色",Bold:"太字","Background Color":"背景色",Show:"表示する"},"Config|Misc":{General:"全体的な設定","Re-Login":"LANカードを選んで（再）接続","Full Screen":"全画面化","Select Language":"言語の選択","To make your choice effective, Restart mekiku-M.":"言語選択を有効にするには、mekiku-Mを再起動してください。","Save log":"ログを保存する","Save note":"メモを保存する","Save main log":"表示部のログを保存する","Save chat log":"連絡窓のログを保存する","Startup Settings":"起動時設定","Keep Last Settings":"前回終了時の設定を初期設定にする"},"Config|Main":{"Main Display":"メイン表示部","Display style":"表示形式",Normal:"通常表示","Full Width":"幅を最大化","Full Window":"ウインドウ内最大化","Line Height":"1行の高さ","Scroll interval per line":"1行のスクロール間隔",msec:"ミリ秒"},"Config|Input":{"Parentheses on F8 press":"F8押下時に囲む文字","Parentheses on Shift+F8 press":"Shift+F8押下時に囲む文字","“":"「","”":"」","(":"（",")":"）"},"Config|Chat":{"Notification Color":"通知時の背景色","Play sound on timer-notifications":"タイマー通知で音を出す"},"Config|Monitor":{"Background Color On Loss":"通信断の際の背景色"},"Config|PFT":{"Background Color (Name)":"前ロール名の背景色","Background Color (Name of Other Panes)":"非選択前ロール名の背景色","Display All":"全ウインドウを表示","Current Window Width":"選択中のウインドウ幅","Same As Others (x1.0)":"他と同じ（1.0倍）","50% wider (x1.5)":"他の5割増（1.5倍）","double (x2.0)":"他の2倍（2.0倍）","triple (x3.0)":"他の3倍（3.0倍）"},"Menu|Menu":{Menu:"メニュー",File:"ファイル",Edit:"編集","Re-Login":"LANカードを選んで（再）接続","Open Settings...":"設定ファイルを開く...","Save Settings As...":"設定に名前をつけて保存...","Config...":"設定...","Reset All Settings":"設定を初期化","Current As Default":"現在の設定を初期設定にする","Full Screen":"全画面化","Version...":"バージョン...",Exit:"終了","mekiku-M settings files":"mekiku-M設定ファイル",Undo:"元に戻す",Cut:"切り取り",Copy:"コピー",Paste:"貼り付け","Select All":"すべて選択"}},this._dicts.th={MyName:{English:"ภาษาไทย"},General:{OK:"OK",Cancel:"ยกเลิก",Error:"ข้อผิดพลาด",Warning:"เตือน","all files":"ไฟล์ทั้งหมด","Error occured on file access.\nIf another application is using it, first quit it.":"เกิดข้อผิดพลาดในการอ่านไฟล์\nถ้าแอพพลิเคชั่นอื่นกำลังใช้ไฟล์นี้\nให้ปิดไฟล์นี้ก่อน"},Input:{"Input Window":"หน้าต่างอินพุท"},Chat:{Chat:"แช็ท",Start:"เริ่ม",Halt:"หยุด",Reset:"ตั้งใหม่","Increase Timer By A Minute":"เพิ่มเวลาเป็น A นาที","Decrease Timer By A Minute":"ลดเวลาเป็น A นาที","0:00":"0:00","30 seconds to next turn.":"อีกสามสิบวิ.จะเริ่มใหม่"," : ":" : ","It's new turn now.":"เริ่มใหม่","Timer started. Next ":"ไทเมอร์เริ่ม ถัดไป ","Timer halted.":"ไทเมอร์หยุด "},Monitor:{"Input Monitor":"มอนิเตอร์อินพุท",name:"ชื่อ","current input window":"หน้าต่างที่กำลังอินพุท",connect:"เชื่อมต่อ"},PFT:{"PFT (Pre-Formatted Text)":"พรีฟอร์แม็ทเท็กซ์","Open... (Ctrl+O)":"เปิด... (Ctrl+O)","Save As (Ctrl+S)":"บันทึกเป็น... (Ctrl+S)","Next Comment (Ctrl+down)":"คอมเมนต์ถัดไป (Ctrl+down)","Previous Comment (Ctrl+up)":"คอมเมนต์ก่อนหน้า (Ctrl+up)","Next Window (Ctrl+right)":"หน้าต่างถัดไป (Ctrl+right)","Previous Window (Ctrl+left)":"หน้าต่างก่อนหน้า (Ctrl+left)","PFT files":"พีเอฟทีไฟล์ ","UTF-8 PFT files":"UTF-8 พีเอฟทีไฟล์ ","Unicode PFT files":"ยูนิโค้ด พีเอฟทีไฟล์ ","text files":"เท็กซ์ไฟล์"},PftMon:{"PFT Monitor":"มอนิเตอร์พีเอฟที","'s Pre-Formatted Text":"พรีฟอร์แม็ทเท็กซ์"},Fkey:{Shortcut:"ปุ่มลัด","Parenthesize all":"วงเล็บทั้งหมด ",Undo:"กลับที่เดิม","(Not available)":"(ไม่สามารถใช้ได้)"},Note:{},Log:{Log:"ล็อก"},Login:{Login:"ล็อกอิน ","LAN card":"แลนการ์ด",Name:"ชื่อ",Channel:"ช่องทาง",Group:"กลุ่ม","The network port is occupied by other application.\nSelect another channel and login.":"เน็ทเวิร์คพอร์ต\nมีแอพพลิเคชั่นอื่นใช้อยู่\nเลือกช่องทางอื่นแล้ว\nล็อกอิน","Network error occurs. Make sure network connection.":"เกิดข้อผิดพลาดจากเน็ทเวิร์ค \nตรวจสอบการเชื่อมต่อ\nเน็ทเวิร์ค","(No Network Available)":"(ไม่มีเน็ทเวิร์ค)"},Config:{Config:"การตั้งค่า "},"Config|General":{"Font Size":"ขนาดฟอนต์","Font Name":"ฟ้อนต์","Font Color":"สีฟ้อนต์",Bold:"ตัวหนา","Background Color":"สีพื้นหลัง",Show:"แสดง"},"Config|Misc":{General:"การติดตั้งทั้งหมด","Re-Login":"ล็อกอินใหม่","Full Screen":"เต็มจอภาพ","Select Language":"เลือกภาษา","To make your choice effective, Restart mekiku-M.":"เพื่อให้ได้งานตามที่คุณ เลือก, เริ่มเปิด mekiku-M อีกครั้ง","Save log":"บันทึก","Save main log":"บันทึก (ล็อกหน้าต่างหลัก)","Save chat log":"บันทึก (ล็อกหน้าต่างแช็ท)","Startup Settings":"ตั้งค่าเริ่มต้น","Keep Last Settings":"ตั้งเป็นค่าล่าสุด"},"Config|Main":{"Main Display":"จอแสดงผลหลัก","Display style":"การแสดงรูปแบบ",Normal:"ปกติ","Full Width":"ความกว้างเต็มจอ","Full Window":"เต็มหน้าต่าง","Line Height":"ความสูงบรรทัด","Scroll interval per line":"ระยะห่างของสกรอล ต่อบรรทัด",msec:"มิลลิเซ็คเคิ่น"},"Config|Input":{"Parentheses on F8 press":"ใส่วงเล็บโดยกด F8","Parentheses on Shift+F8 press":"Shift+F8","“":'""',"”":'""',"(":"(",")":")"},"Config|Chat":{"Notification Color":"สีเตือน"},"Config|Monitor":{"Background Color On Loss":"สีพื้นหลัง  เปิดและตัด"},"Config|PFT":{"Background Color (Name)":"สีพื้นหลัง(ชื่อไฟล์)","Background Color (Name of Other Panes)":"สีพื้นหลัง(ชื่อไฟล์อื่น)","Display All":"ดิสเพลย์ทั้งหมด","Current Window Width":"ความกว้างหน้าต่างปัจจุบัน","Same As Others (x1.0)":"เหมือนอื่นๆ","50% wider (x1.5)":"กว้างขึ้น 1.5 เท่า","double (x2.0)":"2 เท่า","triple (x3.0)":"3 เท่า"},"Menu|Menu":{Menu:"เมนู",File:"ไฟล์",Edit:"การแก้ไข","Re-Login":"ล็อกอินใหม่","Open Settings...":"เปิดไฟล์ตั้งค่าที่เซฟไว้ ...","Save Settings As...":"บันทึกค่าที่ตั้งไว้เป็น ...","Config...":"การตั้งค่า ...","Reset All Settings":"ตั้งค่าใหม่หมด","Current As Default":"ตั้งค่าปัจจุบันเป็นค่าเริ่มต้น","Full Screen":"เต็มจอภาพ","Version...":"เวอร์ชั่น ...",Exit:"ออก","mekiku-M settings files":"ไฟล์ตั้งค่า mekiku-M",Undo:"เลิกทำ",Cut:"ตัด",Copy:"คัดลอก",Paste:"วาง","Select All":"เลือกทั้งหมด"}}}}t.T=o,o._instance=null,o._isMac=!1},882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,t.Util=class{static beforeOf(e,t){const n=e.indexOf(t);return n<0?e:e.substring(0,n)}static isRoomNameLegit(e){return/^[A-Za-z0-9]+$/.test(e)}static contains(e,...t){for(const n in t)if(e.indexOf(t[n])>=0)return!0;return!1}static isString(e){return"string"==typeof e||e instanceof String}static isNumber(e){return"number"==typeof e&&isFinite(e)}static toNumber(e,t=0){if(this.isNumber(e))return e;if(this.isString(e)){const t=parseInt(e,10);if(!1===Number.isNaN(t))return t}return t}static getNowUTCTimeString(){const e=new Date;return`${e.getUTCHours().toString().padStart(2,"0")}:${e.getUTCMinutes().toString().padStart(2,"0")}:${e.getUTCSeconds().toString().padStart(2,"0")}.${e.getUTCMilliseconds().toString().padStart(3,"0")}`}static arraySum(e,t){var n=0;return e.forEach(((e,i,o)=>{n+=t(e,i,o)})),n}static toLf(e){return e.replace(/\r\n?/g,"\n")}static toCrLf(e){return this.toLf(e).replace(/\n/g,"\r\n")}static toStringWithZero(e,t){return("0".repeat(t)+e.toFixed(0)).slice(-t)}static getNewLineCode(){return this.isWin()?"\r\n":"\n"}static isWin(){return!!window.navigator.platform.toLowerCase().includes("win")}static isMac(){const e=window.navigator.platform.toLowerCase();return!!(e.includes("mac")||e.includes("iphone")||e.includes("ipad"))}static getShortcutTextRaw(e){return e.length<1?"":(this.isMac()?"Cmd+":"Ctrl+")+e.charAt(0)}static getShortcutText(e){return e.length<1?"":" "+this.getShortcutTextRaw(e)}static getShortcutParenthesized(e){return e.length<1?"":" ("+this.getShortcutTextRaw(e)+")"}static getShiftShortcutTextRaw(e){return e.length<1?"":(this.isMac()?"Shift+Cmd+":"Ctrl+Shift+")+e.charAt(0)}static getShiftShortcutText(e){return e.length<1?"":" "+this.getShiftShortcutTextRaw(e)}static getShiftShortcutParenthesized(e){return e.length<1?"":" ("+this.getShiftShortcutTextRaw(e)+")"}static numberToText2(e){return e.toString().padStart(2,"0")}static getIsoModifiedDateTimeString(){const e=new Date;return`${e.getFullYear().toString()}-${this.numberToText2(e.getMonth()+1)}-${this.numberToText2(e.getDate())}_${this.numberToText2(e.getHours())}:${this.numberToText2(e.getMinutes())}:${this.numberToText2(e.getSeconds())}`}static getIsoStyleDateString(){const e=new Date;return`${e.getFullYear().toString()}-${this.numberToText2(e.getMonth()+1)}-${this.numberToText2(e.getDate())}`}static async digestMessage(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}constructor(){}}},441:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorManager=void 0;class n{constructor(){this.userColors=[]}color(e){var t;return this.userColors.find((t=>t.id===e)),this.userColors.findIndex((t=>t.id===e)),null===(t=this.userColors.find((t=>t.id===e)))||void 0===t?void 0:t.hsl}regist(e){const t=this.userColors.find((e=>{e.id}));if(void 0!==t)return t.hsl;let i={h:0,s:0,l:25};for(let e=0;e<48;e++){let t=this.selectColor(e);if(this.userColors.findIndex((e=>n.areSameHSLs(e.hsl,t)))<0){i=t;break}}const o={id:e,hsl:i};return this.userColors.push(o),i}unregist(e){this.userColors=this.userColors.filter((t=>t.id!==e))}clear(){this.userColors=[]}static toString(e){return`hsl(${e.h} , ${e.s}%, ${e.l}%)`}static white(){return{h:0,s:100,l:100}}static areSameHSLs(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l}selectColor(e){return e<0&&(e=-e),e<12?{h:(5*e*30+120)%360,s:100,l:75}:e<24?{h:(5*(e-12)*30+120)%360,s:100,l:50}:e<36?{h:(5*(e-24)*30+15+120)%360,s:100,l:75}:e<48?{h:(5*(e-36)*30+15+120)%360,s:100,l:50}:{h:113*(e-48)+120,s:100,l:62}}}t.ColorManager=n},359:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UtilDom=void 0;const i=n(882);class o{constructor(){}static getQuery(){const e=location.search;return e.length>0&&"?"===e[0]?e.substring(1):""}static setQuery(e){history.replaceState({},"","?"+e)}static getWidth(e){return e?e.getBoundingClientRect().width:-1}static show(e){null!=e&&(e.style.visibility="visible")}static hide(e){null!=e&&(e.style.visibility="hidden")}static isShown(e){return null!=e&&"visible"===e.style.visibility}static displayOn(e,t="initial"){null!=e&&(e.style.display=t)}static displayOff(e){null!=e&&(e.style.display="none")}static isDisplayed(e){return null!=e&&"none"!==e.style.display}static makeDialogsRespondToKey(){for(const e of document.querySelectorAll("div.dialog")){if(e.classList.contains("ignore_return"))continue;const t=e.querySelector("button.submit"),n=null!=t?t:void 0,i=e.querySelector("button.cancel"),s=null!=i?i:void 0;for(const t of e.querySelectorAll('input[type="text"]'))t.addEventListener("keydown",(e=>{e.keyCode===o.KEY_ENTER&&(null==n||n.click()),e.keyCode===o.KEY_ESC&&(null==s||s.click())}));for(const t of e.querySelectorAll('input[type="password"]'))t.addEventListener("keydown",(e=>{e.keyCode===o.KEY_ENTER&&(null==n||n.click()),e.keyCode===o.KEY_ESC&&(null==s||s.click())}))}}static getFKeyNumber(e){if(e.length<2||e.length>3)return-1;if("F"!==e.charAt(0))return-1;const t=Number(e.substr(1));return Number.isInteger(t)&&t>0?t:-1}static getFKeyNumberByKeyCode(e){return e<112||e>123?-1:e-111}static getCtrlOrFKeyNumber(e){const t=this.getFKeyNumberByKeyCode(e.keyCode);return t>=0?t:e.key>="0"&&e.key<="9"&&this.isCommandOrControlPressed(e)?parseInt(e.key):/^Digit[0-9]$/.test(e.code)&&this.isCommandOrControlPressed(e)?parseInt(e.code.substr(5)):-1}static isCommandOrControlPressed(e){return navigator.platform,i.Util.isMac()?e.metaKey:e.ctrlKey}static parseFloatEx(e,t=0){return null!==e?parseFloat(e):t}static makeFontFamily(e,t="sans-serif"){return null===e||e.trim().length<1?t:e.trim()===t?e:e+" , "+t}static addSelectOption(e,t,n){const i=document.createElement("option");i.text=t,i.value=n,e.add(i)}static extractCSSRulesByText(e){return this.extractCSSRules((t=>t.cssText.indexOf(e)>=0))}static extractCSSRules(e){var t=[];for(const n of document.styleSheets)for(const i of n.cssRules)e(i)&&t.push(i);return t}static getModifierKey(e){return(e.shiftKey?this.MK_SHIFT:0)+(e.ctrlKey?this.MK_CTRL:0)+(e.altKey?this.MK_ALT:0)+(e.metaKey?this.MK_META:0)}static getLuminance(e){const t=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.exec(e);if(null===t)return-1;if(t[3]){const e=parseInt(t[1],16),n=parseInt(t[2],16),i=parseInt(t[3],16);return(Math.max(e,n,i)+Math.min(e,n,i))/2}return-1}}t.UtilDom=o,o.MK_SHIFT=1,o.MK_CTRL=2,o.MK_ALT=4,o.MK_META=8,o.KEY_TAB=9,o.KEY_ENTER=13,o.KEY_CTRL=17,o.KEY_ESC=27,o.KEY_ARROW_LEFT=37,o.KEY_ARROW_UP=38,o.KEY_ARROW_RIGHT=39,o.KEY_ARROW_DOWN=40,o.KEY_A=65,o.KEY_B=66,o.KEY_C=67,o.KEY_D=68,o.KEY_E=69,o.KEY_F=70,o.KEY_G=71,o.KEY_H=72,o.KEY_I=73,o.KEY_J=74,o.KEY_K=75,o.KEY_L=76,o.KEY_M=77,o.KEY_N=78,o.KEY_O=79,o.KEY_P=80,o.KEY_Q=81,o.KEY_R=82,o.KEY_S=83,o.KEY_T=84,o.KEY_U=85,o.KEY_V=86,o.KEY_W=87,o.KEY_X=88,o.KEY_Y=89,o.KEY_Z=90}},t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();